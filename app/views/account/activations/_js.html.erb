<script type='text/javascript'>
  $(document).ready(function() {
    flatpickr('.datetimepicker', { altInput: true })

    $('#activation_country').select2();

    var labels = $("label[for='activation_serial'], label[for='activation_serial_no'], #span_serial, #span_serial_no")

    function setDisabledStateOfInputs (runTime) {
      isSerialNumberInputsPresent = $('#activation_serial').val() !== '' || $('#activation_serial_no').val() !== ''

      if (isSerialNumberInputsPresent) {
        $('#activation_document_no').prop('disabled', true)
        $("label[for='activation_document_no']").addClass('text-muted')
      } else if (!isSerialNumberInputsPresent && runTime === 'change') {
        $('#activation_document_no').prop('disabled', false)
        $("label[for='activation_document_no']").removeClass('text-muted')
      }

      if ($('#activation_document_no').val() !== '') {
        $('#activation_serial, #activation_serial_no').prop('disabled', true)
        labels.addClass('text-muted')
      } else if ($('#activation_document_no').val() === '' && runTime === 'change') {
        $('#activation_serial, #activation_serial_no').prop('disabled', false)
        labels.removeClass('text-muted')
      }
    }

    setDisabledStateOfInputs('init')

    $('#activation_serial, #activation_serial_no, #activation_document_no').on('input', function () {
      setDisabledStateOfInputs('change')
    })

    // entering and validating international telephone numbers  --------------->
    var input = document.querySelector('#activation_mobile_phone'),
      error_msg = document.querySelector('#error-msg');

    var error_messages = <%= raw t('intl_tel_input.errors').values %>

    var reset = function () {
      input.classList.remove('is-invalid');
      input.classList.remove('is-valid');
      error_msg.innerHTML = '';
    };

    var iti = window.intlTelInput(input, {
      utilsScript: 'assets/shared/intl_tel_input_utils.js',
      nationalMode: false,
      initialCountry: 'tr',
      preferredCountries: ['tr']
    })

    input.addEventListener('blur', function() {
      reset();
      if (input.value.trim()) {
        if (iti.isValidNumber()) {
          input.classList.add('is-valid');
        } else {
          input.classList.add('is-invalid');
          var error_code = iti.getValidationError();
          error_msg.innerHTML = error_messages[error_code] || error_messages[0]
        }
      }
    });

    input.addEventListener('change', reset);
    input.addEventListener('keyup', reset);
  })
</script>
